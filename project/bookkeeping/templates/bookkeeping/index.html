{% extends 'base.html' %}
{% load table_cell %}

{% block head %}
<script src="https://code.highcharts.com/highcharts.src.js"></script>
{% endblock head %}


{% block content %}

<div class="row my-2 border-bottom border-primary">
    <div class="col-lg-4 pr-3">
        {% include 'bookkeeping/includes/months_balance.html' %}
    </div>

    <div class="col-lg-8 pl-3">
        {% include 'bookkeeping/includes/months_expense_type.html' %}
    </div>
</div>

<div class="row my-2 border-bottom border-primary">
    <div class="col-lg-5">
        {% include 'bookkeeping/includes/chart_expenses.html' %}
    </div>

    <div class="col-lg-7">
        {% include 'bookkeeping/includes/chart_balance.html' %}
    </div>
</div>

<div class="row mt-4 mb-3">
    <div class="col-lg-12">
        {% url 'bookkeeping:accounts_worth_new' as url_accounts %}
        <button type="button" class="btn btn-sm btn-outline-success js-create" data-url="{{ url_accounts }}"><i class="fas fa-plus"></i> Įrašyti sąskaitose esančias sumas</button>
        {% url 'bookkeeping:savings_worth_new' as url_expenses_new %}
        <button type="button" class="btn btn-sm btn-outline-success js-create" data-url="{{ url_expenses_new }}"><i class="fas fa-plus"></i> Įrašyti fondų rinkos vertes</button>
    </div>
</div>

<!-- accounts stats -->
<div class="row mt-2">
    <div id="accounts_worth" class="col-md-7 pr-2">{{ accounts }}</div>
    <div class="col-md-3 pl-2">
        <table class="table table-striped table-hover table-sm stats">
            <thead>
                <tr class="top">
                    <th class="text-right">Metų pradžioje</th>
                    <th class="text-right">Metų pabaigoje</th>
                    <th class="text-right">Metų balansas</th>
                </tr>
            </thead>
            <tfoot>
                <tr>
                    {% cell amount_start tag='th' %}
                    {% cell amount_end tag='th' %}
                    {% cell amount_balance tag='th' highlight_value=True %}
                </tr>
            </tfoot>
        </table>

        <table class="table table-striped table-hover table-sm stats">
            <thead>
                <tr class="top">
                    <th data-toggle="tooltip" data-html="true" data-placement="right" title="<p>Nebūtinos išlaidos, kurių galima atsisakyti:<br />- Darbas<br />- Laisvalaikis<br />- Paskolos<br />- Taupymas<br />- Transportas" style="border-left: 5px solid red!important;" class="text-left">{{ save_sum }}</th>
                    <th class="text-right">€ + F</th>
                    <th class="text-right">€ + F + P</th>
                </tr>
            </thead>
            <tbody>
                {% for item in no_incomes %}
                <tr>
                    <td>{% if item.label == 'money' %}Pinigai, € {% endif %}{% if item.label == 'no_cut' %}Nekeičiant išlaidų, mėn{% endif %}{% if item.label == 'cut' %}Sumažinus išlaidas, mėn{% endif %}</td>
                    <td>{{ item.money_fund|floatformat:0 }}</td>
                    <td>{{ item.money_fund_pension|floatformat:0 }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <p>
            <b>€</b> - sąskaitose esantys pinigai<br />
            <b>F</b> - Fondai<br />
            <b>P</b> - Pensijų fondai
        </p>
    </div>

    <div class="col-md-2">
        <!-- Average Incomes -->
        <table class="table table-striped table-hover table-sm stats">
            <thead>
                <tr class="top"><th class="text-right">Vidutinė pajamos</th></tr>
            </thead>
            <tfoot>
                <tr>{% cell avg_incomes tag='th' %}</tr>
            </tfoot>
        </table>

        <!-- Average Expenses -->
        <table class="table table-striped table-hover table-sm stats">
            <thead>
                <tr class="top"><th class="text-right">Vidutinė išlaidos</th></tr>
            </thead>
            <tfoot>
                <tr>{% cell avg_expenses tag='th' %}</tr>
            </tfoot>
        </table>

        <!-- Money -->
        <table class="table table-striped table-hover table-sm stats">
            <thead>
                <tr class="top"><th class="text-right">Pinigai</th></tr>
            </thead>
            <tfoot>
                <tr>{% cell amount_start tag='th' %}</tr>
            </tfoot>
        </table>

        <!-- Worth -->
        <table class="table table-striped table-hover table-sm stats">
            <thead>
                <tr class="top"><th class="text-right">Turtas</th></tr>
            </thead>
            <tfoot>
                <tr>{% cell amount_start|add:total_market tag='th' %}</tr>
            </tfoot>
        </table>
    </div>
</div>


<!-- savings -->
<div class="row mt-5">
    <div id="saving_worth" class="col-lg-8">{{ savings }}</div>
</div>


<div class="modal fade" id="modal-form">
    <div class="modal-dialog modal-md">
        <div class="modal-content"></div>
    </div>
</div>

<style>
    .tooltip.show p {
        text-align: left;
    }
</style>
<script>
    $(document).ready(function () {
        $('[data-toggle="tooltip"]').tooltip();
    });
</script>
{% endblock content %}

