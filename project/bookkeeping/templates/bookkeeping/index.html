{% extends 'base.html' %}
{% load table_cell %}

{% block head %}
<script src="https://code.highcharts.com/highcharts.src.js"></script>
{% endblock head %}


{% block content %}

<div class="row my-2 border-bottom border-primary">
    <div class="col-lg-4 pr-3">{{ year_balance }}</div>

    <div class="col-lg-8 pl-3">{{ year_expenses }}</div>
</div>

<div class="row my-2 border-bottom border-primary">
    <div class="col-lg-5">
        {% include 'bookkeeping/includes/chart_expenses.html' %}
    </div>

    <div class="col-lg-7">
        {% include 'bookkeeping/includes/chart_balance.html' %}
    </div>
</div>

<div class="row mt-4 mb-3">
    <div class="col-lg-12">
        {% url 'bookkeeping:accounts_worth_new' as url_accounts %}
        <button type="button" class="btn btn-sm btn-outline-success js-create" data-url="{{ url_accounts }}"><i class="fas fa-plus"></i> Sąskaitų faktas</button>
        {% url 'bookkeeping:savings_worth_new' as url_expenses_new %}
        <button type="button" class="btn btn-sm btn-outline-success js-create" data-url="{{ url_expenses_new }}"><i class="fas fa-plus"></i> Fondų faktas</button>
        {% url 'bookkeeping:pensions_worth_new' as url_pensions_new %}
        <button type="button" class="btn btn-sm btn-outline-success js-create" data-url="{{ url_pensions_new }}"><i class="fas fa-plus"></i> Pensijos faktas</button>
        <a class="btn btn-sm btn-outline-secondary"
            href="{% url 'core:regenerate_balances_current_year' year %}" data-toggle="tooltip"
            data-placement="top" title="Bus atnaujintas šių metų balansas."><i class="fas fa-sync"> </i> Atnaujinti {{ year|safe }} balansus</a>
        <a class="btn btn-sm btn-outline-danger" href="{% url 'core:regenerate_balances' %}" data-toggle="tooltip"
            data-placement="top" title="Bus atnaujinti visų metų balansai."><i class="fas fa-sync"> </i> Atnaujinti balansus</a>
    </div>
</div>

<!-- accounts stats -->
<div class="row mt-2">
    <div id="accounts_worth" class="col-md-7 pr-2">{{ accounts }}</div>
    <div class="col-md-3 pl-2">
        <table class="table table-striped table-hover table-sm stats">
            <thead>
                <tr class="top">
                    <th class="text-right">Metų pradžioje</th>
                    <th class="text-right">Metų pabaigoje</th>
                    <th class="text-right">Metų balansas</th>
                </tr>
            </thead>
            <tfoot>
                <tr>
                    {% cell amount_start tag='th' %}
                    {% cell months_amount_end tag='th' %}
                    {% cell amount_balance tag='th' highlight_value=True %}
                </tr>
            </tfoot>
        </table>

        <div id="no_incomes">{{ no_incomes }}</div>
    </div>

    <div class="col-md-2">
        <!-- Average Incomes -->
        <table class="table table-striped table-hover table-sm stats">
            <thead>
                <tr class="top"><th class="text-right">Vidutinė pajamos</th></tr>
            </thead>
            <tfoot>
                <tr>{% cell avg_incomes tag='th' %}</tr>
            </tfoot>
        </table>

        <!-- Average Expenses -->
        <table class="table table-striped table-hover table-sm stats">
            <thead>
                <tr class="top"><th class="text-right">Vidutinė išlaidos</th></tr>
            </thead>
            <tfoot>
                <tr>{% cell avg_expenses tag='th' %}</tr>
            </tfoot>
        </table>

        <!-- Money -->
        <table class="table table-striped table-hover table-sm stats">
            <thead>
                <tr class="top"><th class="text-right">Pinigai</th></tr>
            </thead>
            <tfoot>
                <tr>{% cell wealth_money tag='th' %}</tr>
            </tfoot>
        </table>

        <!-- Worth -->
        <table class="table table-striped table-hover table-sm stats">
            <thead>
                <tr class="top"><th class="text-right">Turtas</th></tr>
            </thead>
            <tfoot>
                <tr>{% cell wealth tag='th' %}</tr>
            </tfoot>
        </table>
    </div>
</div>


<!-- savings -->
<div class="row mt-5">
    <div id="saving_worth" class="col-lg-8">{{ savings }}</div>
</div>

<!-- pensions -->
<div class="row mt-5">
    <div id="pension_worth" class="col-lg-8">{{ pensions }}</div>
</div>


<div class="modal fade" id="modal-form">
    <div class="modal-dialog modal-md">
        <div class="modal-content"></div>
    </div>
</div>

<style>
    .tooltip.show p {
        text-align: left;
    }
</style>
<script>
    $(document).ready(function () {
        $('[data-toggle="tooltip"]').tooltip();
    });
</script>
{% endblock content %}

