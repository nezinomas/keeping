{% load i18n %}
{% load slippers %}
{% load get_item %}
{% load math %}

{% if items %}
<table class="table table-sm table-striped table-hover">
    <thead>
        <tr>
            <th class="text-start right-grey-border" rowspan="2">{% regenerate_balances type=type %} {{ title }}</th>
            <th colspan="2" class="text-center">{% translate 'Past years' %}</th>
            <th colspan="2" class="text-center left-grey-border right-grey-border">{{ request.user.year }}</th>
            <th colspan="4" class="text-center">{% translate 'Total' %}</th>
            <th colspan="2" rowspan="2" class="left-grey-border right-blue-border">{% if percentage_from_incomes %} {% translate 'From incomes' %}: {{ percentage_from_incomes|floatformat:'1g' }}%{% endif %}</th>
            <th colspan="4" rowspan="2" class="text-center">{% translate 'Profit' %}/{% translate 'Loss' %}</th>
        </tr>
        <tr>
            <th colspan="2" class="text-center">{% translate 'Transferred' %}</th>
            <th colspan="2" class="text-center left-grey-border right-grey-border">{% translate 'Transferred' %}</th>
            <th colspan="2" class="text-center">{% translate 'Transferred' %}</th>
            <th colspan="2" class="text-center">{% translate 'Sold' %}</th>
        </tr>
        <tr>
            <th class="text-start right-grey-border">{% translate 'Fund' %}</th>
            <th>{% translate 'Sum' %}</th>
            <th class="right-grey-border">{% translate 'Fees' %}</th>
            <th>{% translate 'Sum' %}</th>
            <th class="right-grey-border">{% translate 'Fees' %}</th>
            <th>{% translate 'Sum' %}</th>
            <th>{% translate 'Fees' %}</th>
            <th>{% translate 'Sum' %}</th>
            <th class="right-grey-border">{% translate 'Fees' %}</th>
            <th>{% translate 'Invested' %}</th>
            <th class="right-blue-border">{% translate 'Market value' %}</th>
            <th>{% translate 'Sum' %}</th>
            <th>%</th>
        </tr>
    </thead>
    <tbody>
        {% for item in items %}
        <tr>
            {% if type == 'savings' %}{% var obj_type='saving_type'%}{% else %}{% var obj_type='pension_type' %}{% endif %}
            <td data-bs-toggle="tooltip" data-bs-html="true" data-bs-placement="right" title="{{ item.latest_check }}" class="text-start right-grey-border">{{ item|get_obj_attr:obj_type }}</td>
            {% table_cell value=item.past_amount|price css_class='w6' %}
            {% table_cell value=item.past_fee|price css_class='w6 right-grey-border' %}
            {% table_cell value=item.per_year_incomes|price css_class='w6' %}
            {% table_cell value=item.per_year_fee|price css_class='w6 right-grey-border' %}
            {% table_cell value=item.incomes|price css_class='w6' %}
            {% table_cell value=item.fee|price css_class='w6' %}
            {% table_cell value=item.sold|price css_class='w6' %}
            {% table_cell value=item.sold_fee|price css_class='w6  right-grey-border' %}
            {% table_cell value=item.invested|price css_class='w6' %}
            {% table_cell value=item.market_value|price css_class='right-blue-border w6' %}
            {% table_cell value=item.profit_sum|price text_after='€' highlight_value=True css_class='w6' %}
            {% table_cell value=item.profit_proc text_after='%' highlight_value=True css_class='w6' %}
        </tr>
        {% endfor %}
    </tbody>
    <tfoot>
        <tr >
            <th class="text-start right-grey-border">{% translate 'Total' %}</th>
            {% table_cell value=total_row.past_amount|price tag='th' %}
            {% table_cell value=total_row.past_fee|price tag='th' css_class="right-grey-border" %}
            {% table_cell value=total_row.per_year_incomes|price tag='th' %}
            {% table_cell value=total_row.per_year_fee|price tag='th' css_class="right-grey-border" %}
            {% table_cell value=total_row.incomes|price tag='th' %}
            {% table_cell value=total_row.fee|price tag='th' %}
            {% table_cell value=total_row.sold|price tag='th' %}
            {% table_cell value=total_row.sold_fee|price tag='th' css_class="right-grey-border" %}
            {% table_cell value=total_row.invested|price tag='th' %}
            {% table_cell value=total_row.market_value|price tag='th' css_class='right-blue-border' %}
            {% table_cell value=total_row.profit_sum|price text_after='€' highlight_value=True tag='th' %}
            {% table_cell value=total_row.profit_proc text_after='%' highlight_value=True tag='th' %}
        </tr>
    </tfoot>
</table>

<script>setUpToolTip();</script>

{% endif %}
