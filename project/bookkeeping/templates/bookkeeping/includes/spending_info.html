{% load cell_format %}
{% load i18n %}
{% load math %}

<table class="table table-sm table-hover">
    <thead>
        <tr>
            <th></th>
            <th>{% translate 'Plan' %}</th>
            <th>{% translate 'Fact' %}</th>
            <th>{% translate 'Delta' %}</th>
        </tr>
    </thead>
    <tbody>
        {% for item in ctx %}
        <tr>
            <td>{{item.title}}</td>
            <td>{{item.plan|price|cellformat}}</td>

            {% if item.title == _('Incomes') or item.title == _('Balance') %}

            <td class="{{item.fact|compare:item.plan}}">{{item.fact|price|cellformat:"0,00"}}</td>
                {% with item.fact|sub:item.plan as val %}<td class="{{val|positive_negative}}">{{val|price|cellformat:"0,00"}}</td>{% endwith %}

            {% else %}

                <td class="{{item.plan|compare:item.fact}}">{{item.fact|price|cellformat:"0,00"}}</td>
                {% with item.plan|sub:item.fact as val %}<td class="{{val|positive_negative}}">{{val|price|cellformat:"0,00"}}</td>{% endwith %}

            {% endif %}
        </tr>
        {% endfor %}
    </tbody>
</table>
