class YearPicker{constructor(e={}){this.currentInput=null,this.currentDecadeStart=null,this.minYear=1900,this.maxYear=2100,this.isVisible=!1,this.dropdownId=e.dropdownId||"year-picker-dropdown",this.dropdown=null,this.init()}createDropdown(){const e=document.createElement("div");e.id=this.dropdownId,e.className="year-picker-dropdown",e.style.display="none",e.setAttribute("aria-hidden","true"),e.innerHTML='\n            <div class="year-picker-header">\n                <button class="year-picker-nav prev" type="button" aria-label="Previous decade">&lt;</button>\n                <span class="year-picker-range" role="status" aria-live="polite"></span>\n                <button class="year-picker-nav next" type="button" aria-label="Next decade">&gt;</button>\n            </div>\n            <div class="year-picker-grid" role="grid"></div>\n            <div class="year-picker-footer">\n                <button class="year-picker-clear" type="button" aria-label="Clear selection">Clear</button>\n            </div>\n        ',document.body.appendChild(e),this.dropdown=e,this.rangeSpan=this.dropdown.querySelector(".year-picker-range"),this.grid=this.dropdown.querySelector(".year-picker-grid"),this.prevBtn=this.dropdown.querySelector(".year-picker-nav.prev"),this.nextBtn=this.dropdown.querySelector(".year-picker-nav.next"),this.clearBtn=this.dropdown.querySelector(".year-picker-clear"),this.bindNavigationEvents()}init(){this.bindGlobalEvents(),this.initializeInputs()}initializeInputs(){document.querySelectorAll(".year-picker-input").forEach(e=>{e.setAttribute("aria-haspopup","true"),e.setAttribute("role","combobox"),e.setAttribute("aria-label","Year picker input"),e.setAttribute("readonly","readonly");const t=t=>{t.preventDefault(),t.stopPropagation(),this.showPicker(e)};e.addEventListener("click",t),e.addEventListener("touchstart",t,{passive:!1})})}bindGlobalEvents(){const e=e=>{this.isVisible&&this.dropdown&&!this.dropdown.contains(e.target)&&!e.target.classList.contains("year-picker-input")&&this.hidePicker()};document.addEventListener("click",e),document.addEventListener("touchstart",e,{passive:!1}),document.addEventListener("keydown",e=>{"Escape"===e.key&&this.isVisible&&this.hidePicker()})}bindNavigationEvents(){const e=e=>t=>{t.stopPropagation(),this.navigateDecade(e)};this.prevBtn.addEventListener("click",e(-12)),this.prevBtn.addEventListener("touchstart",e(-12),{passive:!1}),this.nextBtn.addEventListener("click",e(12)),this.nextBtn.addEventListener("touchstart",e(12),{passive:!1}),this.clearBtn.addEventListener("click",e=>{e.stopPropagation(),this.clearValue()}),this.clearBtn.addEventListener("touchstart",e=>{e.stopPropagation(),this.clearValue()},{passive:!1})}showPicker(e){this.dropdown||this.createDropdown(),this.currentInput=e,this.minYear=parseInt(e.dataset.minYear)||1900,this.maxYear=parseInt(e.dataset.maxYear)||2100;const t=e.value,n=t?parseInt(t):(new Date).getFullYear();this.currentDecadeStart=12*Math.floor(n/12),this.positionDropdown(e),this.renderYears(n),this.updateClearButton(),this.dropdown.style.display="block",this.dropdown.setAttribute("aria-hidden","false"),this.isVisible=!0}hidePicker(){this.dropdown&&(this.dropdown.style.display="none",this.dropdown.setAttribute("aria-hidden","true")),this.isVisible=!1,this.currentInput=null}positionDropdown(e){const t=e.getBoundingClientRect(),n=window.pageYOffset||document.documentElement.scrollTop,i=window.pageXOffset||document.documentElement.scrollLeft,r=this.findParentModal(e),a=window.innerHeight||document.documentElement.clientHeight;if(r){this.dropdown.style.position="fixed",this.dropdown.style.left=Math.max(10,t.left)+"px";let e=t.bottom+8;const n=this.dropdown.scrollHeight||300,i=a-t.bottom,r=t.top;i<n&&r>n?(this.dropdown.style.top=Math.max(10,t.top-n-8)+"px",this.dropdown.setAttribute("data-positioned-above","true")):(this.dropdown.style.top=e+"px",this.dropdown.removeAttribute("data-positioned-above"))}else{this.dropdown.style.position="absolute",this.dropdown.style.left=t.left+i+"px";let e=t.bottom+n+8;const r=this.dropdown.scrollHeight||300,s=a-(t.bottom+n),o=t.top+n;s<r&&o>r?(this.dropdown.style.top=Math.max(10,t.top+n-r-8)+"px",this.dropdown.setAttribute("data-positioned-above","true")):(this.dropdown.style.top=e+"px",this.dropdown.removeAttribute("data-positioned-above"))}this.setModalZIndex(e,r),this.adjustPositionIfNeeded()}setModalZIndex(e,t=null){if(t||(t=this.findParentModal(e)),t){const e=this.getElementZIndex(t);let n=Math.max(e+10,10001);this.dropdown.setAttribute("data-in-modal","true"),this.dropdown.setAttribute("data-modal-z-index",n),this.dropdown.style.zIndex=n}else this.dropdown.removeAttribute("data-in-modal"),this.dropdown.removeAttribute("data-modal-z-index"),this.dropdown.style.zIndex="10000"}adjustPositionIfNeeded(){const e=this.dropdown.getBoundingClientRect(),t=window.innerWidth,n=window.innerHeight||document.documentElement.clientHeight;if(e.right>t){const n=e.right-t,i=parseInt(this.dropdown.style.left);this.dropdown.style.left=Math.max(10,i-n-10)+"px"}if(e.left<0&&(this.dropdown.style.left="10px"),e.bottom>n){const t=this.currentInput.getBoundingClientRect(),n=e.height;if("fixed"===this.dropdown.style.position)this.dropdown.style.top=Math.max(10,t.top-n-8)+"px";else{const e=window.pageYOffset||document.documentElement.scrollTop;this.dropdown.style.top=Math.max(10,t.top+e-n-8)+"px"}this.dropdown.setAttribute("data-positioned-above","true")}}findParentModal(e){let t=e.parentElement;for(;t&&t!==document.body;){const e=window.getComputedStyle(t),{position:n,zIndex:i}=e;if(t.classList.contains("modal")||t.classList.contains("modal-dialog")||"fixed"===n&&(t.classList.contains("modal")||t.classList.contains("dialog")||t.classList.contains("popup")||t.classList.contains("overlay")||t.classList.contains("MuiModal-root")||t.classList.contains("MuiDialog-root")||t.classList.contains("fixed")&&t.classList.contains("inset-0"))||"fixed"===n&&parseInt(i)>100)return t;t=t.parentElement}return null}getElementZIndex(e){const{zIndex:t}=window.getComputedStyle(e);return"auto"===t?0:parseInt(t)||0}navigateDecade(e){this.currentDecadeStart+=e,this.currentDecadeStart<this.minYear-11&&(this.currentDecadeStart=12*Math.floor(this.minYear/12)),this.currentDecadeStart>this.maxYear&&(this.currentDecadeStart=12*Math.floor(this.maxYear/12));const t=this.currentInput.value?parseInt(this.currentInput.value):null;this.renderYears(t)}renderYears(e=null){this.grid.innerHTML="";const t=this.currentDecadeStart+11,n=Math.max(this.currentDecadeStart,this.minYear),i=Math.min(t,this.maxYear);this.rangeSpan.textContent=`${n}-${i}`,this.prevBtn.disabled=this.currentDecadeStart<=12*Math.floor(this.minYear/12),this.nextBtn.disabled=this.currentDecadeStart>=12*Math.floor(this.maxYear/12);for(let n=this.currentDecadeStart;n<=t;n++){const t=document.createElement("div");if(t.className="year-item",t.textContent=n,t.setAttribute("role","gridcell"),t.setAttribute("aria-label",`Year ${n}`),n===e&&(t.classList.add("selected"),t.setAttribute("aria-selected","true")),n<this.minYear||n>this.maxYear)t.classList.add("disabled"),t.setAttribute("aria-disabled","true");else{t.classList.add("selectable");const e=()=>this.selectYear(n);t.addEventListener("click",e),t.addEventListener("touchstart",e,{passive:!1})}this.grid.appendChild(t)}}selectYear(e){if(this.currentInput){this.currentInput.value=e,this.currentInput.classList.add("year-picker-has-value");const t=new Event("change",{bubbles:!0});this.currentInput.dispatchEvent(t);const n=new CustomEvent("yearSelected",{bubbles:!0,detail:{year:e,input:this.currentInput}});this.currentInput.dispatchEvent(n)}this.hidePicker()}clearValue(){if(this.currentInput){const e=this.currentInput.value;this.currentInput.value="",this.currentInput.classList.remove("year-picker-has-value");const t=new Event("change",{bubbles:!0});this.currentInput.dispatchEvent(t);const n=new CustomEvent("yearCleared",{bubbles:!0,detail:{oldValue:e,input:this.currentInput}});this.currentInput.dispatchEvent(n)}this.hidePicker()}updateClearButton(){this.currentInput&&this.currentInput.value?(this.clearBtn.style.display="inline-block",this.clearBtn.textContent=`Clear (${this.currentInput.value})`):this.clearBtn.style.display="none"}}document.addEventListener("DOMContentLoaded",function(){window.yearPicker||(window.yearPicker=new YearPicker)}),window.initYearPicker=function(e,t={}){const n=document.getElementsByClassName(e);return n.length?(window.yearPicker||(window.yearPicker=new YearPicker),Array.from(n).forEach(e=>{e.classList.add("year-picker-input"),e.setAttribute("readonly","readonly"),e.setAttribute("aria-haspopup","true"),e.setAttribute("role","combobox"),e.setAttribute("aria-label","Year picker input"),t.minYear&&(e.dataset.minYear=t.minYear),t.maxYear&&(e.dataset.maxYear=t.maxYear),t.defaultYear&&(e.value=t.defaultYear),e.removeEventListener("click",e._yearPickerHandler),e.removeEventListener("touchstart",e._yearPickerHandler),e._yearPickerHandler=function(t){t.preventDefault(),t.stopPropagation(),window.yearPicker.showPicker(e)},e.addEventListener("click",e._yearPickerHandler),e.addEventListener("touchstart",e._yearPickerHandler,{passive:!1})}),window.yearPicker):(console.warn(`Year picker: No elements with class '${e}' found`),null)},window.addYearPicker=function(e,t={}){const n=document.querySelectorAll(e),i=[];return n.forEach(e=>{if(e.id)i.push(window.initYearPicker(e.id,t));else{const n="year-picker-"+Math.random().toString(36).substr(2,9);e.id=n,i.push(window.initYearPicker(n,t))}}),i},window.removeYearPicker=function(e){const t=document.getElementById(e);t&&t._yearPickerHandler&&(t.removeEventListener("click",t._yearPickerHandler),t.removeEventListener("touchstart",t._yearPickerHandler),t.classList.remove("year-picker-input"),t.removeAttribute("readonly"),t.removeAttribute("aria-haspopup"),t.removeAttribute("role"),t.removeAttribute("aria-label"),delete t._yearPickerHandler)},window.initYearPickerForModal=function(e,t={}){const n=window.initYearPicker(e,t);return n&&n.dropdown&&t.zIndex&&(n.dropdown.style.zIndex=t.zIndex,n.dropdown.setAttribute("data-manual-z-index",t.zIndex)),n},window.setYearPickerZIndex=function(e=10001){window.yearPicker&&window.yearPicker.dropdown&&(window.yearPicker.dropdown.style.zIndex=e,window.yearPicker.dropdown.setAttribute("data-manual-z-index",e))},window.updateYearPicker=function(e,t={}){const n=document.getElementById(e);n&&(void 0!==t.minYear&&(n.dataset.minYear=t.minYear),void 0!==t.maxYear&&(n.dataset.maxYear=t.maxYear),void 0!==t.value&&(n.value=t.value),void 0!==t.zIndex&&window.yearPicker&&(window.yearPicker.dropdown.style.zIndex=t.zIndex,window.yearPicker.dropdown.setAttribute("data-manual-z-index",t.zIndex)))},window.clearYearPicker=function(e){const t=document.getElementById(e);if(t&&window.yearPicker){const e=t.value;t.value="",t.classList.remove("year-picker-has-value");const n=new Event("change",{bubbles:!0});t.dispatchEvent(n);const i=new CustomEvent("yearCleared",{bubbles:!0,detail:{oldValue:e,input:t}});t.dispatchEvent(i)}},window.hasYearPickerValue=function(e){const t=document.getElementById(e);return!!t&&!!t.value},window.getYearPickerValue=function(e){const t=document.getElementById(e);return t?t.value:null},window.setYearPickerValue=function(e,t){const n=document.getElementById(e);if(n){const e=n.value;n.value=t,t?n.classList.add("year-picker-has-value"):n.classList.remove("year-picker-has-value");const i=new Event("change",{bubbles:!0});if(n.dispatchEvent(i),t){const e=new CustomEvent("yearSelected",{bubbles:!0,detail:{year:t,input:n,programmatic:!0}});n.dispatchEvent(e)}else{const t=new CustomEvent("yearCleared",{bubbles:!0,detail:{oldValue:e,input:n,programmatic:!0}});n.dispatchEvent(t)}}},window.resetYearPickerPositioning=function(){window.yearPicker&&window.yearPicker.dropdown&&(window.yearPicker.dropdown.removeAttribute("data-manual-z-index"),window.yearPicker.dropdown.classList.remove("force-front"),window.yearPicker.currentInput&&window.yearPicker.positionDropdown(window.yearPicker.currentInput))};